{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["import { jwtDecode } from \"jwt-decode\";\r\nimport { cookies } from \"next/headers\";\r\nimport type { NextRequest } from \"next/server\";\r\nimport { NextResponse } from \"next/server\";\r\n\r\ntype Role = keyof typeof roleBasedPrivateRoutes;\r\n\r\nconst AuthRoutes = [\"/login\", \"/register\"];\r\n\r\nconst roleBasedPrivateRoutes = {\r\n  SUPER_ADMIN: [/^\\/dashboard/],\r\n  // ADMIN: [/^\\/dashboard/],\r\n  // USER: [/^\\/dashboard/],\r\n};\r\n\r\nexport async function middleware(request: NextRequest) {\r\n  const { pathname } = request.nextUrl;\r\n\r\n  const cookieStore = await cookies();\r\n  const accessToken = cookieStore.get(\"accessToken\")?.value;\r\n\r\n  if (!accessToken) {\r\n    if (AuthRoutes.includes(pathname)) {\r\n      return NextResponse.next();\r\n    } else {\r\n      return NextResponse.redirect(new URL(\"/login\", request.url));\r\n    }\r\n  }\r\n\r\n  let decodedData = null;\r\n  decodedData = jwtDecode(accessToken) as any;\r\n  const role = decodedData?.role;\r\n\r\n  // Check if user is trying to access dashboard\r\n  if (pathname.startsWith(\"/dashboard\")) {\r\n    // If user has a valid role and token, allow access to dashboard\r\n    if (role && roleBasedPrivateRoutes[role as Role]) {\r\n      const routes = roleBasedPrivateRoutes[role as Role];\r\n      if (routes.some((route) => pathname.match(route))) {\r\n        return NextResponse.next();\r\n      }\r\n    }\r\n    // If user doesn't have proper role, redirect to home\r\n    return NextResponse.redirect(new URL(\"/\", request.url));\r\n  }\r\n\r\n  // For non-dashboard routes, allow authenticated users to proceed\r\n  return NextResponse.next();\r\n}\r\n\r\nexport const config = {\r\n  matcher: [\"/login\", \"/register\", \"/dashboard/:path*\"],\r\n};\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AAAA;AAEA;AAAA;;;;AAIA,MAAM,aAAa;IAAC;IAAU;CAAY;AAE1C,MAAM,yBAAyB;IAC7B,aAAa;QAAC;KAAe;AAG/B;AAEO,eAAe,WAAW,OAAoB;IACnD,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,MAAM,cAAc,MAAM,IAAA,qTAAO;IACjC,MAAM,cAAc,YAAY,GAAG,CAAC,gBAAgB;IAEpD,IAAI,CAAC,aAAa;QAChB,IAAI,WAAW,QAAQ,CAAC,WAAW;YACjC,OAAO,+TAAY,CAAC,IAAI;QAC1B,OAAO;YACL,OAAO,+TAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;QAC5D;IACF;IAEA,IAAI,cAAc;IAClB,cAAc,IAAA,qOAAS,EAAC;IACxB,MAAM,OAAO,aAAa;IAE1B,8CAA8C;IAC9C,IAAI,SAAS,UAAU,CAAC,eAAe;QACrC,gEAAgE;QAChE,IAAI,QAAQ,sBAAsB,CAAC,KAAa,EAAE;YAChD,MAAM,SAAS,sBAAsB,CAAC,KAAa;YACnD,IAAI,OAAO,IAAI,CAAC,CAAC,QAAU,SAAS,KAAK,CAAC,SAAS;gBACjD,OAAO,+TAAY,CAAC,IAAI;YAC1B;QACF;QACA,qDAAqD;QACrD,OAAO,+TAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,KAAK,QAAQ,GAAG;IACvD;IAEA,iEAAiE;IACjE,OAAO,+TAAY,CAAC,IAAI;AAC1B;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;QAAU;QAAa;KAAoB;AACvD"}}]
}