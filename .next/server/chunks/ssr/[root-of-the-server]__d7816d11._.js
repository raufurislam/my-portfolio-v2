module.exports=[92782,(a,b,c)=>{"use strict";b.exports=a.r(66382).vendored["react-ssr"].React},73280,(a,b,c)=>{"use strict";b.exports=a.r(66382).vendored.contexts.AppRouterContext},8264,(a,b,c)=>{"use strict";b.exports=a.r(66382).vendored.contexts.HooksClientContext},62743,(a,b,c)=>{"use strict";b.exports=a.r(66382).vendored.contexts.ServerInsertedHtml},21351,(a,b,c)=>{"use strict";b.exports=a.r(66382).vendored["react-ssr"].ReactDOM},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},66382,(a,b,c)=>{"use strict";b.exports=a.r(18622)},11755,(a,b,c)=>{"use strict";b.exports=a.r(66382).vendored["react-ssr"].ReactJsxRuntime},56267,(a,b,c)=>{b.exports=a.r(89941)},11642,a=>{"use strict";a.s(["AuthProvider",()=>v,"useAuth",()=>w,"withAuth",()=>x],11642);var b=a.i(11755),c=a.i(92782),d=a.i(56267),e=a.i(95811);let f=new class{ACCESS_TOKEN_KEY="accessToken";REFRESH_TOKEN_KEY="refreshToken";USER_DATA_KEY="userData";getAccessToken(){return null}getRefreshToken(){return null}getUserData(){return null}setAccessToken(a){}setRefreshToken(a){}setUserData(a){}setAuthData(a,b){a.accessToken&&this.setAccessToken(a.accessToken),a.refreshToken&&this.setRefreshToken(a.refreshToken),b&&this.setUserData(b)}clearAuthData(){}isAuthenticated(){let a=this.getAccessToken();if(!a)return!1;try{let b=JSON.parse(atob(a.split(".")[1])),c=Math.floor(Date.now()/1e3);return b.exp>c}catch(a){return console.error("Error validating token:",a),!1}}isSuperAdmin(){let a=this.getUserData();return a?.role==="SUPER_ADMIN"&&a?.name==="Super admin"}getTokenFromCookies(a,b){return a&&a.split(";").reduce((a,b)=>{let[c,d]=b.trim().split("=");return a[c]=d,a},{})[b]||null}validateToken(a){if(!a)return!1;try{let b=JSON.parse(atob(a.split(".")[1])),c=Math.floor(Date.now()/1e3);return b.exp>c}catch(a){return console.error("Error validating token:",a),!1}}},{getAccessToken:g,getRefreshToken:h,getUserData:i,setAccessToken:j,setRefreshToken:k,setUserData:l,setAuthData:m,clearAuthData:n,isAuthenticated:o,isSuperAdmin:p,getTokenFromCookies:q,validateToken:r}=f,s="https://raufurislam-server.vercel.app/api/v1",t=new class{async handleResponse(a){if(!a.ok)throw Error((await a.json().catch(()=>({}))).message||`HTTP error! status: ${a.status}`);return a.json()}async login(a){let b=await fetch(`${s}/auth/login`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return this.handleResponse(b)}async register(a){let b=await fetch(`${s}/user/register`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return this.handleResponse(b)}async logout(){(await fetch(`${s}/auth/logout`,{method:"POST",credentials:"include"})).ok||console.warn("Logout request failed, but clearing local state")}async refreshAccessToken(){let a=await fetch(`${s}/auth/refresh-token`,{method:"POST",credentials:"include"});return this.handleResponse(a).then(a=>a.data)}async getCurrentUser(){let a=f.getUserData(),b=f.getAccessToken();if(a&&b&&f.isAuthenticated())return console.log("✅ Using cached user data from localStorage"),a;let c=await fetch(`${s}/auth/me`,{method:"GET",credentials:"include"});if(401===c.status)return f.clearAuthData(),null;let d=await this.handleResponse(c).then(a=>a.data);return d&&f.setUserData(d),d}},u=(0,c.createContext)(void 0);function v({children:a}){let[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(!0),k=(0,d.useRouter)(),l=!!g,m=g?.role==="SUPER_ADMIN"&&g?.name==="Super admin";(0,c.useEffect)(()=>{n()},[]);let n=async()=>{try{j(!0),console.log("🔍 Initializing auth..."),console.log("🔍 API URL:","https://raufurislam-server.vercel.app/api/v1"),console.log("🔍 Current cookies:",document.cookie);let a=f.getUserData(),b=f.getAccessToken();if(a&&b&&f.isAuthenticated()){console.log("✅ Found valid user data in localStorage:",a),h(a),j(!1);return}let c=await t.getCurrentUser();console.log("🔍 getCurrentUser response:",c),c?(h(c),f.setUserData(c),console.log("✅ User set in context and localStorage:",c)):(console.log("❌ No user data received, clearing user state"),h(null),f.clearAuthData())}catch(a){console.error("❌ Failed to initialize auth:",a),h(null),f.clearAuthData()}finally{j(!1)}},o=async a=>{try{j(!0),console.log("🔐 Starting login process...");let b=await t.login(a);if(console.log("🔐 Login response:",b),b.success&&b.data.user)h(b.data.user),f.setUserData(b.data.user),b.data.accessToken&&f.setAccessToken(b.data.accessToken),b.data.refreshToken&&f.setRefreshToken(b.data.refreshToken),console.log("✅ Login successful, user set:",b.data.user),console.log("🍪 Cookies after login:",document.cookie),console.log("💾 Stored in localStorage:",f.getUserData()),e.toast.success(b.message||"Login successful!"),k.push("/");else throw Error(b.message||"Login failed")}catch(b){console.error("❌ Login error:",b);let a=b instanceof Error?b.message:"Login failed. Please try again.";throw e.toast.error(a),b}finally{j(!1)}},p=async a=>{try{j(!0);let b=await t.register(a);if(b.success){e.toast.success(b.message||"Registration successful!");try{let b=await t.login({email:a.email,password:a.password});b.success&&b.data.user&&(h(b.data.user),f.setUserData(b.data.user),b.data.accessToken&&f.setAccessToken(b.data.accessToken),b.data.refreshToken&&f.setRefreshToken(b.data.refreshToken),e.toast.success("Welcome! You are now logged in."))}catch(a){console.log("Auto-login failed after registration:",a),e.toast.success("Registration successful! Please login manually."),k.push("/login");return}k.push("/")}else throw Error(b.message||"Registration failed")}catch(b){console.error("Registration error:",b);let a=b instanceof Error?b.message:"Registration failed. Please try again.";throw e.toast.error(a),b}finally{j(!1)}},q=async()=>{try{j(!0),await t.logout(),h(null),f.clearAuthData(),e.toast.success("Logged out successfully"),k.push("/")}catch(a){console.error("Logout error:",a),h(null),f.clearAuthData(),e.toast.success("Logged out successfully"),k.push("/")}finally{j(!1)}},r=async()=>{try{let a=await t.refreshAccessToken();if(a.accessToken&&f.setAccessToken(a.accessToken),a.refreshToken&&f.setRefreshToken(a.refreshToken),a&&a.user){let b=a.user;h(b),f.setUserData(b)}}catch(a){throw console.error("Token refresh failed:",a),h(null),f.clearAuthData(),k.push("/login"),a}};return(0,b.jsx)(u.Provider,{value:{user:g,isLoading:i,isAuthenticated:l,login:o,register:p,logout:q,refreshToken:r,isSuperAdmin:m},children:a})}function w(){let a=(0,c.useContext)(u);if(void 0===a)throw Error("useAuth must be used within an AuthProvider");return a}function x(a,e={}){let{redirectTo:f="/login",requireAuth:g=!0}=e;return function(e){let{user:h,isLoading:i}=w(),j=(0,d.useRouter)();return((0,c.useEffect)(()=>{i||(g&&!h?j.push(f):!g&&h&&j.push("/dashboard"))},[h,i,j]),i)?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})}):g&&!h||!g&&h?null:(0,b.jsx)(a,{...e})}}},28813,a=>{"use strict";a.s(["ThemeProvider",()=>i,"useTheme",()=>h]);var b=a.i(92782),c=(a,b,c,d,e,f,g,h)=>{let i=document.documentElement,j=["light","dark"];function k(b){var c;(Array.isArray(a)?a:[a]).forEach(a=>{let c="class"===a,d=c&&f?e.map(a=>f[a]||a):e;c?(i.classList.remove(...d),i.classList.add(f&&f[b]?f[b]:b)):i.setAttribute(a,b)}),c=b,h&&j.includes(c)&&(i.style.colorScheme=c)}if(d)k(d);else try{let a=localStorage.getItem(b)||c,d=g&&"system"===a?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":a;k(d)}catch(a){}},d=["light","dark"],e="(prefers-color-scheme: dark)",f=b.createContext(void 0),g={setTheme:a=>{},themes:[]},h=()=>{var a;return null!=(a=b.useContext(f))?a:g},i=a=>b.useContext(f)?b.createElement(b.Fragment,null,a.children):b.createElement(k,{...a}),j=["light","dark"],k=({forcedTheme:a,disableTransitionOnChange:c=!1,enableSystem:g=!0,enableColorScheme:h=!0,storageKey:i="theme",themes:k=j,defaultTheme:p=g?"system":"light",attribute:q="data-theme",value:r,children:s,nonce:t,scriptProps:u})=>{let[v,w]=b.useState(()=>m(i,p)),[x,y]=b.useState(()=>"system"===v?o():v),z=r?Object.values(r):k,A=b.useCallback(a=>{let b=a;if(!b)return;"system"===a&&g&&(b=o());let e=r?r[b]:b,f=c?n(t):null,i=document.documentElement,j=a=>{"class"===a?(i.classList.remove(...z),e&&i.classList.add(e)):a.startsWith("data-")&&(e?i.setAttribute(a,e):i.removeAttribute(a))};if(Array.isArray(q)?q.forEach(j):j(q),h){let a=d.includes(p)?p:null,c=d.includes(b)?b:a;i.style.colorScheme=c}null==f||f()},[t]),B=b.useCallback(a=>{let b="function"==typeof a?a(v):a;w(b);try{localStorage.setItem(i,b)}catch(a){}},[v]),C=b.useCallback(b=>{y(o(b)),"system"===v&&g&&!a&&A("system")},[v,a]);b.useEffect(()=>{let a=window.matchMedia(e);return a.addListener(C),C(a),()=>a.removeListener(C)},[C]),b.useEffect(()=>{let a=a=>{a.key===i&&(a.newValue?w(a.newValue):B(p))};return window.addEventListener("storage",a),()=>window.removeEventListener("storage",a)},[B]),b.useEffect(()=>{A(null!=a?a:v)},[a,v]);let D=b.useMemo(()=>({theme:v,setTheme:B,forcedTheme:a,resolvedTheme:"system"===v?x:v,themes:g?[...k,"system"]:k,systemTheme:g?x:void 0}),[v,B,a,x,g,k]);return b.createElement(f.Provider,{value:D},b.createElement(l,{forcedTheme:a,storageKey:i,attribute:q,enableSystem:g,enableColorScheme:h,defaultTheme:p,value:r,themes:k,nonce:t,scriptProps:u}),s)},l=b.memo(({forcedTheme:a,storageKey:d,attribute:e,enableSystem:f,enableColorScheme:g,defaultTheme:h,value:i,themes:j,nonce:k,scriptProps:l})=>{let m=JSON.stringify([e,d,h,a,j,i,f,g]).slice(1,-1);return b.createElement("script",{...l,suppressHydrationWarning:!0,nonce:k,dangerouslySetInnerHTML:{__html:`(${c.toString()})(${m})`}})}),m=(a,b)=>{},n=a=>{let b=document.createElement("style");return a&&b.setAttribute("nonce",a),b.appendChild(document.createTextNode("*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(b),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(b)},1)}},o=a=>(a||(a=window.matchMedia(e)),a.matches?"dark":"light")},1148,a=>{"use strict";a.s(["ThemeProvider",()=>d]);var b=a.i(11755),c=a.i(28813);function d({children:a,...d}){return(0,b.jsx)(c.ThemeProvider,{...d,children:a})}},26419,a=>{"use strict";a.s(["Toaster",()=>e]);var b=a.i(11755),c=a.i(28813),d=a.i(95811);let e=({...a})=>{let{theme:e="system"}=(0,c.useTheme)();return(0,b.jsx)(d.Toaster,{theme:e??"system",className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...a})}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__d7816d11._.js.map